{"ast":null,"code":"import _classCallCheck from \"/Users/drashti/Documents/battleship-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/drashti/Documents/battleship-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/drashti/Documents/battleship-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/drashti/Documents/battleship-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/drashti/Documents/battleship-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/drashti/Documents/battleship-project/src/react/components/home/CreateGameButton.js\";\nimport React from \"react\";\nimport { withAsyncAction } from \"../../HOCs\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"..\";\nimport { WaitScreen } from \"../waitScreen/\";\nimport { checkReadyStart, startGame } from \"../../../redux/actionCreators\";\nimport \"./CreateGameButton.css\";\n\nvar CreateGameButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CreateGameButton, _React$Component);\n\n  function CreateGameButton() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CreateGameButton);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CreateGameButton)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      goToSetup: false,\n      gameCreated: false,\n      message: \"\",\n      gameNumber: \"0\",\n      hasPostedStart: false\n    };\n\n    _this.handleClick = function () {\n      var gameNumber = _this.generateGameNumber();\n\n      _this.props.login({\n        username: \"playerA\",\n        password: \"playerA\"\n      });\n\n      _this.setState({\n        gameNumber: gameNumber,\n        gameCreated: true,\n        message: _this.generateMessage(gameNumber)\n      });\n\n      _this.interval = setInterval(_this.checkReadyStart, 5000);\n    };\n\n    _this.checkReadyStart = function () {\n      if (_this.props.token) {\n        if (_this.state.hasPostedStart === false) {\n          if (_this.state.gameNumber !== \"0\") {\n            _this.props.startGame(_this.state.gameNumber, _this.props.token);\n\n            _this.setState({\n              hasPostedStart: true\n            });\n          }\n        }\n      }\n\n      _this.props.checkReadyStart().then(function (result) {\n        result.payload.messages.map(function (message) {\n          if (_this.state.gameNumber !== \"0\") {\n            if (message.text === \"Game \" + _this.state.gameNumber + \" start\") {\n              if (message.username === \"playerB\") {\n                _this.setState({\n                  goToSetup: true\n                });\n              }\n            }\n          }\n\n          return message.text;\n        });\n      });\n    };\n\n    _this.generateLoginData = function () {\n      return {\n        username: \"playerA\",\n        password: \"playerA\"\n      };\n    };\n\n    _this.generateGameNumber = function () {\n      var gameNumber = \"\";\n\n      for (var i = 1; i <= 4; i++) {\n        var digit = Math.floor(Math.random() * 10);\n        gameNumber = gameNumber + digit;\n      }\n\n      return gameNumber;\n    };\n\n    _this.generateMessage = function (gameNumber) {\n      return \"Waiting for your opponent to join.  Please let them know that your game number is \" + gameNumber;\n    };\n\n    return _this;\n  }\n\n  _createClass(CreateGameButton, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.checkReadyStart();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.interval);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.goToSetup === true) {\n        return React.createElement(Redirect, {\n          to: \"/setup\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, this.state.gameCreated && React.createElement(WaitScreen, {\n        message: this.state.message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        id: \"createNewGame\",\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, \"Create New Game\"));\n    }\n  }]);\n\n  return CreateGameButton;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  if (state.auth.login.result) {\n    return {\n      token: state.auth.login.result.token\n    };\n  } else return {};\n};\n\nvar mapDispatchToProps = {\n  checkReadyStart: checkReadyStart,\n  startGame: startGame\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(withAsyncAction(\"auth\", \"login\")(CreateGameButton));","map":{"version":3,"sources":["/Users/drashti/Documents/battleship-project/src/react/components/home/CreateGameButton.js"],"names":["React","withAsyncAction","connect","Redirect","WaitScreen","checkReadyStart","startGame","CreateGameButton","state","goToSetup","gameCreated","message","gameNumber","hasPostedStart","handleClick","generateGameNumber","props","login","username","password","setState","generateMessage","interval","setInterval","token","then","result","payload","messages","map","text","generateLoginData","i","digit","Math","floor","random","clearInterval","Component","mapStateToProps","auth","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { withAsyncAction } from \"../../HOCs\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"..\";\nimport { WaitScreen } from \"../waitScreen/\";\nimport { checkReadyStart, startGame } from \"../../../redux/actionCreators\";\nimport \"./CreateGameButton.css\";\n\nclass CreateGameButton extends React.Component {\n  state = {\n    goToSetup: false,\n    gameCreated: false,\n    message: \"\",\n    gameNumber: \"0\",\n    hasPostedStart: false\n  };\n\n  componentDidMount() {\n    this.checkReadyStart();\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  handleClick = () => {\n    const gameNumber = this.generateGameNumber();\n    this.props.login({ username: \"playerA\", password: \"playerA\" });\n\n    this.setState({\n      gameNumber: gameNumber,\n      gameCreated: true,\n      message: this.generateMessage(gameNumber)\n    });\n    this.interval = setInterval(this.checkReadyStart, 5000);\n  };\n\n  checkReadyStart = () => {\n    if (this.props.token) {\n      if (this.state.hasPostedStart === false) {\n        if (this.state.gameNumber !== \"0\") {\n          this.props.startGame(this.state.gameNumber, this.props.token);\n          this.setState({ hasPostedStart: true });\n        }\n      }\n    }\n\n    this.props.checkReadyStart().then(result => {\n      result.payload.messages.map(message => {\n        if (this.state.gameNumber !== \"0\") {\n          if (message.text === \"Game \" + this.state.gameNumber + \" start\") {\n            if (message.username === \"playerB\") {\n              this.setState({ goToSetup: true });\n            }\n          }\n        }\n        return message.text;\n      });\n    });\n  };\n\n  generateLoginData = () => {\n    return { username: \"playerA\", password: \"playerA\" };\n  };\n\n  generateGameNumber = () => {\n    let gameNumber = \"\";\n    for (let i = 1; i <= 4; i++) {\n      let digit = Math.floor(Math.random() * 10);\n      gameNumber = gameNumber + digit;\n    }\n    return gameNumber;\n  };\n\n  generateMessage = gameNumber => {\n    return (\n      \"Waiting for your opponent to join.  Please let them know that your game number is \" +\n      gameNumber\n    );\n  };\n\n  render() {\n    if (this.state.goToSetup === true) {\n      return <Redirect to=\"/setup\" />;\n    }\n    return (\n      <React.Fragment>\n        {this.state.gameCreated && <WaitScreen message={this.state.message} />}\n        <button id=\"createNewGame\" onClick={this.handleClick}>\n          Create New Game\n        </button>\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  if (state.auth.login.result) {\n    return {\n      token: state.auth.login.result.token\n    };\n  } else return {};\n};\n\nconst mapDispatchToProps = {\n  checkReadyStart,\n  startGame\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withAsyncAction(\"auth\", \"login\")(CreateGameButton));\n"]},"metadata":{},"sourceType":"module"}